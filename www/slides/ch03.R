###################################################
### chunk number 1: preliminaries
###################################################
options(width=60)
library(EngrExpt)
options(show.signif.stars = FALSE)
#lattice.options(default.theme = function() standard.theme(color=FALSE))


###################################################
### chunk number 2: dhazefm1
###################################################
fm1 <- aov(dhaze ~ treatment, dhaze)
summary(fm1)
model.tables(fm1, type = "means")
str(resid(fm1))


###################################################
### chunk number 3: fm2
###################################################
fm2 <- aov(lw ~ comp2 + comp1, lw)


###################################################
### chunk number 4: fm2summary
###################################################
summary(fm2)


###################################################
### chunk number 5: fm2table
###################################################
model.tables(fm2)
str(resid(fm2))


###################################################
### chunk number 6: ovendot
###################################################
show(dotplot(type ~ moisture|reorder(brand,moisture), oven,
             type = c("p","a"), pch=21,
             xlab = "Percentage of moisture remaining in silica after 15 min. drying",
             auto.key = list(columns = 3, lines = TRUE),
             jitter.y = TRUE, strip=FALSE, strip.left=TRUE,
             layout = c(1,3)))


###################################################
### chunk number 7: fm3
###################################################
summary(fm3 <- aov(moisture ~ type * brand, oven))
str(fitted(fm3))


###################################################
### chunk number 8: ex331
###################################################
ex331 <- data.frame(x = c(2,9,3,5,1), y = c(1,17,3,9,0))


###################################################
### chunk number 9: ex331plot
###################################################
show(xyplot(y ~ x, ex331, type = c("g","p","r"), aspect = 'xy'))


###################################################
### chunk number 10: fm4
###################################################
summary(fm4 <- lm(y ~ x, ex331))


###################################################
### chunk number 11: ex333
###################################################
ex333 <-
    data.frame(x = c(9,2,5,8,4,1,3,7,6),
               y = c(253.5,7.1,74.1,165.2,32.,1.9,18.1,136.1,100))
print(xyplot(y ~ x, ex333, type = c("g","p")),
      split = c(1,1,2,1), more = TRUE)
print(xyplot(y ~ x, ex333,
             type = c("g","p","r"), scales = list(log = 2)),
      split = c(2,1,2,1))


###################################################
### chunk number 12: fm5
###################################################
summary(fm5 <- lm(log(y) ~ log(x), ex333))


###################################################
### chunk number 13: ex336
###################################################
ex336 <- data.frame(x = c(18,18,20,20,22,22,24,24,26,26),
           y = c(4.0,4.2,5.6,6.1,6.5,6.8,5.4,5.6,3.3,3.6))


###################################################
### chunk number 14: ex336fig
###################################################
show(xyplot(y ~ x, ex336, type = c("g","p"), aspect = 0.8))


###################################################
### chunk number 15: fm6
###################################################
summary(fm6 <- lm(y ~ x + I(x^2), ex336))


###################################################
### chunk number 16: yield
###################################################
str(yield)


###################################################
### chunk number 17: fm7
###################################################
summary(fm7 <- lm(yield ~ temp + pH, yield))


